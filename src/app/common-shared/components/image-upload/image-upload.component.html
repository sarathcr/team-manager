<ngx-dropzone
  *ngIf="variant !== 'custom'; else custom"
  class="image-upload d-flex {{ imageURL ? 'image-upload_no-border' : '' }}"
  [ngClass]="{ 'image-upload_sm': variant === 'dropzone_sm' }"
  (change)="onSelect($event)"
  [multiple]="false"
  [accept]="acceptedType"
  [maxFileSize]="maxFileSize"
  [disableClick]="imageURL || loading ? true : false"
>
  <div
    class="image-upload__preview"
    [ngClass]="{ 'image-upload__preview_loading': loading }"
    *ngIf="imageURL"
  >
    <div
      class="image-upload__close d-flex align-items-center justify-content-center"
      (click)="onRemove($event)"
    >
      <span class="icon icon-ic_share_close image-upload__icon"></span>
    </div>
    <img
      [src]="imageURL"
      alt="image"
      class="image-upload__preview_image {{
        imageLoaded ? 'd-block' : 'd-none'
      }}"
      (load)="onPreviewLoaded()"
      (error)="onPreviewError()"
    />
  </div>
  <ngx-dropzone-label *ngIf="!imageURL && !loading">
    <div class="icon-ic_upload image-upload__label-icon"></div>
    <div class="image-upload__label-text">{{ label }}</div>
    <div class="image-upload__label-text" *ngIf="maxFileSize">
      {{ 'PROJECT.project_upload_file_limit' | translate: sizeInMB() }}
    </div>
  </ngx-dropzone-label>
  <app-loader *ngIf="loading || !imageLoaded"></app-loader>
</ngx-dropzone>
<ng-template #custom>
  <label for="upload">
    <app-loader *ngIf="loading || !imageLoaded"></app-loader>
    <ng-content></ng-content>

    <input
      type="file"
      id="upload"
      style="display: none;"
      (change)="transformData($event.target.files)"
      [accept]="acceptedType"
    />
  </label>
</ng-template>

<ng-template #modalUploadRejection>
  <app-modal-info
    id="upload-modal-info"
    [variant]="'unlock'"
    [icon]="'warning'"
    modalTitle="BUSINESS.Error_imagelimit_title"
    [description]="
      'BUSINESS.Error_imagelimit_description' | translate: sizeInMB()
    "
    [confirmLabel]="'BUSINESS.Error_button_gotit'"
    (confirm)="declineModal($event)"
    (decline)="declineModal($event)"
  ></app-modal-info>
</ng-template>
